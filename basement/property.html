<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ü–æ–º–µ—â–µ–Ω–∏–µ</title>

  <!-- Telegram Mini App SDK -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <link rel="stylesheet" href="../style.css">
</head>

<body>

<div class="property-header">
  <button class="back-btn" id="backBtn">‚Üê</button>
  <button class="share-btn" id="shareBtn">–ü–æ–¥–µ–ª–∏—Ç—å—Å—è</button>
</div>

<div class="property-slider">
  <img id="sliderImage" src="">
  <button class="slider-btn prev" id="prevBtn">‚Äπ</button>
  <button class="slider-btn next" id="nextBtn">‚Ä∫</button>
</div>

<div class="property-page-content">
  <div class="property-page-title" id="title"></div>
  <div class="property-page-address" id="address"></div>
  <div class="property-page-description" id="description"></div>
  <div class="property-page-price" id="price"></div>
</div>

<footer class="site-footer">
  <div class="footer-social">
    <a href="https://t.me/snowbobr" target="_blank">
      <svg viewBox="0 0 24 24">
        <path d="M9.04 15.44l-.38 5.36c.55 0 .79-.24 1.08-.52l2.6-2.47 5.39 3.94c.99.55 1.7.26 1.95-.91l3.54-16.6c.31-1.45-.52-2.02-1.49-1.66L1.15 9.77c-1.4.55-1.38 1.34-.24 1.69l5.36 1.67L18.6 6.42"/>
      </svg>
    </a>
  </div>
  <a href="tel:+79265524725" class="footer-phone">+7 (926) 552-47-25</a>
</footer>

<script>
/* ===============================
   1Ô∏è‚É£ TELEGRAM
================================ */
const tg = window.Telegram?.WebApp;

if (tg) {
  tg.ready();
}

/* ===============================
   2Ô∏è‚É£ –ö–ù–û–ü–ö–ê –ù–ê–ó–ê–î
================================ */
document.getElementById("backBtn").addEventListener("click", () => {
  if (window.history.length > 1) {
    window.history.back();
  } else {
    window.location.href = "/index.html";
  }
});

/* ===============================
   3Ô∏è‚É£ –î–ê–ù–ù–´–ï –û–ë–™–ï–ö–¢–ê
================================ */
const properties = {
  "basement-1": {
    title: "–ü–æ–¥–≤–∞–ª—å–Ω–æ–µ –ø–æ–º–µ—â–µ–Ω–∏–µ 45 –∫–≤.–º.",
    address: "üìç —É–ª. –í–æ–ª–æ–∫–æ–ª–∞–º—Å–∫–∏–π –ø—Ä 6 –∫1",
    description: "–°—É—Ö–æ–µ –ø–æ–º–µ—â–µ–Ω–∏–µ, –ø–æ—Ç–æ–ª–∫–∏ 2.5 –º. –û—Ç–ª–∏—á–Ω–æ –ø–æ–¥ —Å–∫–ª–∞–¥ –∏–ª–∏ —Å—Ç—É–¥–∏—é.",
    price: "25 000 000 ‚ÇΩ",
    images: [
      "../images/Volokolamsky_pr_6_k1/Volokolamsky_pr_6_k1_1.jpg",
      "../images/Volokolamsky_pr_6_k1/Volokolamsky_pr_6_k1_2.jpg",
      "../images/Volokolamsky_pr_6_k1/Volokolamsky_pr_6_k1_3.jpg",
      "../images/Volokolamsky_pr_6_k1/Volokolamsky_pr_6_k1_4.jpg"
    ]
  }
};

/* ===============================
   4Ô∏è‚É£ –ó–ê–ì–†–£–ó–ö–ê –û–ë–™–ï–ö–¢–ê
================================ */
const params = new URLSearchParams(window.location.search);
const id = params.get("id");
const item = properties[id];

let index = 0;

title.textContent = item.title;
address.textContent = item.address;
description.textContent = item.description;
price.textContent = item.price;
sliderImage.src = item.images[0];

/* ===============================
   5Ô∏è‚É£ –°–õ–ê–ô–î–ï–†
================================ */
nextBtn.onclick = () => {
  index = (index + 1) % item.images.length;
  sliderImage.src = item.images[index];
};

prevBtn.onclick = () => {
  index = (index - 1 + item.images.length) % item.images.length;
  sliderImage.src = item.images[index];
};

/* ===============================
   6Ô∏è‚É£ –ü–û–î–ï–õ–ò–¢–¨–°–Ø (iOS –Ω–æ—Ä–º–∞–ª—å–Ω–æ, Android —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä)
================================ */
shareBtn.addEventListener("click", () => {
  const url = window.location.href;

  const isIOS = /iPhone|iPad|iPod/i.test(navigator.userAgent);
  const isAndroid = /Android/i.test(navigator.userAgent);

  // ‚úÖ iOS ‚Äî —Å—Ä–∞–∑—É —Å–∏—Å—Ç–µ–º–Ω—ã–π Share Sheet
  if (navigator.share && isIOS) {
    navigator.share({
      title: item.title,
      url: url
    });
    return;
  }

  // ‚úÖ Android –≤ Telegram ‚Äî –æ—Ç–∫—Ä—ã–≤–∞–µ–º –±—Ä–∞—É–∑–µ—Ä
  if (tg && isAndroid) {
    tg.openLink(url);
    return;
  }

  // ‚úÖ –æ–±—ã—á–Ω—ã–π –±—Ä–∞—É–∑–µ—Ä
  if (navigator.share) {
    navigator.share({ title: item.title, url });
  } else {
    navigator.clipboard.writeText(url);
    alert("–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞");
  }
});
</script>

</body>
</html>
